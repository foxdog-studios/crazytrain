<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Crazy trains</title>
  <meta name="description" content="I'm going off the rails of a crazy train">
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
  {{> stationSearch}}
  {{> trainTimes}}
</body>

<template name="stationSearch">
  <form id="station-form">
    <div class="form-group">
      <label for="station-search">Station name</label>
      <input type="text" class="form-control"  id="station-search" value="{{stationName}}" placeholder="Enter the name of a station">
    </div>
  </form>
</template>

<template name="trainTimes">
  <table class="table">
    <tr>
      <th>
        Arrives
      </th>
      <th>
        from
      </th>
      <th>
        platform
      </th>
      <th>
        Departs to
      </th>
      <th>
        at
      </th>
      <th>
        Operator
      </th>
      <th>
        Activated in system
      </th>
    </tr>
  {{#if loaded}}
    {{#each schedules}}
      {{> schedule}}
    {{else}}
      <tr>
        <td colspan="7">
          nothing in the schedule!
        </td>
      </tr>
    {{/each}}
  {{else}}
      <tr>
        <td colspan="7">
          loading...
        </td>
      </tr>
  {{/if}}
  </table>
</template>

<template name="schedule">
  {{#isolate}}
    <tr>
      <td>{{arrival}}</td><td>{{from}}</td><td>{{platform}}</td><td>{{to}}</td><td>{{departure}}</td><td>{{atocCode}}</td><td>{{isActive}}</td>
    </tr>
    {{#with realtimeData}}
      {{#if loc_stanox}}
      <tr>
        <td colspan="7" class="text-info">
          {{#if terminated}}
            Terminated.
          {{/if}}
          Last seen at {{lastSeen}} running {{variation_status}} varying from the timetable by {{timetable_variation}} minutes at {{actualTimestamp}} (planned {{plannedTimestamp}}) and going to {{goingTo}} should be there in {{next_report_run_time}} minutes.
        </td>
      <tr>
      {{/if}}
    {{/with}}
  {{/isolate}}
</template>

